<div class="container">
  <h1>Nuevo Lanzamiento</h1>

  <form [formGroup]="lanzamientoForm" (ngSubmit)="guardar()">
    <div class="form-group-toggle">
      <mat-button-toggle-group formControlName="tipo" aria-label="Tipo de Lanzamiento">
        <mat-button-toggle value="INGRESO">Ingreso</mat-button-toggle>
        <mat-button-toggle value="GASTO">Gasto</mat-button-toggle>
      </mat-button-toggle-group>
    </div>

    <div class="form-grid">
      <mat-form-field appearance="fill" class="form-group">
        <mat-label>Descripción</mat-label>
        <input matInput formControlName="descripcion" placeholder="Ej: Salario mensual">
        <mat-error *ngIf="lanzamientoForm.get('descripcion')?.hasError('required')">Descripción es obligatoria.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="form-group">
        <mat-label>Vencimiento</mat-label>
        <input matInput [matDatepicker]="pickerVencimiento" formControlName="vencimiento">
        <mat-datepicker-toggle matSuffix [for]="pickerVencimiento"></mat-datepicker-toggle>
        <mat-datepicker #pickerVencimiento></mat-datepicker>
        <mat-error *ngIf="lanzamientoForm.get('vencimiento')?.hasError('required')">Vencimiento es obligatorio.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="form-group">
        <mat-label>Fecha de Pago</mat-label>
        <input matInput [matDatepicker]="pickerPago" formControlName="fechaPago">
        <mat-datepicker-toggle matSuffix [for]="pickerPago"></mat-datepicker-toggle>
        <mat-datepicker #pickerPago></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="fill" class="form-group">
        <mat-label>Valor</mat-label>
        <input matInput type="number" formControlName="valor" placeholder="0.00">
        <mat-error *ngIf="lanzamientoForm.get('valor')?.hasError('required')">Valor es obligatorio.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="form-group">
        <mat-label>Categoría</mat-label>
        <mat-select formControlName="categoria">
          <mat-option *ngFor="let cat of categorias" [value]="cat">{{ cat.label }}</mat-option>
        </mat-select>
        <mat-error *ngIf="lanzamientoForm.get('categoria')?.hasError('required')">Categoría es obligatoria.</mat-error>
      </mat-form-field>
      <mat-form-field appearance="fill" class="form-group">
        <mat-label>Persona</mat-label>
        <input
          type="text"
          matInput
          formControlName="persona"
          [matAutocomplete]="autoPersona"
          placeholder="Escriba para buscar...">
        <mat-autocomplete #autoPersona="matAutocomplete" [displayWith]="displayPersona">
          <mat-option *ngFor="let p of personasFiltradas | async" [value]="p">
            {{ p.label }}
          </mat-option>
        </mat-autocomplete>
        <mat-error *ngIf="lanzamientoForm.get('persona')?.hasError('required')">Persona es obligatoria.</mat-error>
      </mat-form-field>
    </div>

    <mat-form-field appearance="fill" class="form-group full-width">
      <mat-label>Observación</mat-label>
      <textarea matInput formControlName="observacion" rows="3"></textarea>
    </mat-form-field>

    <div class="action-buttons-form">
      <button type="submit" class="search-btn" [disabled]="lanzamientoForm.invalid">Guardar</button>
      <button type="button" class="new-btn" (click)="nueva()">Nuevo</button>
      <button type="button" class="text-btn" (click)="volver()">Volver a la búsqueda</button>
    </div>
  </form>
</div>
